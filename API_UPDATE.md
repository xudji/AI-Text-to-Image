# API接口更新说明

## 更新内容

根据后端API接口的变更，前端已进行相应更新以支持新的接口格式。

### 🔄 API接口变更

#### 1. 简化版图像生成接口
- **URL**: `POST /api/v1/images/generate`
- **参数**: 通过URL参数传递
- **参数列表**:
  - `prompt` (必选): 文本提示词
  - `size` (可选): 图像尺寸，默认1328*1328
  - `model` (可选): 模型名称，默认qwen-image-plus

#### 2. 完整版图像生成接口
- **URL**: `POST /api/v1/images/generate/full`
- **参数**: 通过请求体传递
- **请求体结构**:
```json
{
  "model": "qwen-image-plus",
  "input": {
    "messages": [
      {
        "role": "user",
        "content": [
          {
            "text": "一只可爱的小猫"
          }
        ]
      }
    ]
  },
  "parameters": {
    "negative_prompt": "",
    "size": "1328*1328",
    "n": 1,
    "prompt_extend": true,
    "watermark": false
  }
}
```

### 🎨 前端更新内容

#### 1. API服务层更新
- 新增 `GenerateImageSimpleRequest` 接口
- 新增 `GenerateImageFullRequest` 接口
- 更新 `imageService` 方法：
  - `generateImageSimple()` - 简化版API调用
  - `generateImageFull()` - 完整版API调用

#### 2. 生成页面更新
- **参数调整**:
  - 移除 `width`、`height`、`quality` 参数
  - 新增 `size`、`model`、`useFullAPI`、`negativePrompt` 参数
- **UI优化**:
  - 图片尺寸选择器（预设常用尺寸）
  - AI模型选择器
  - API模式切换（简化/完整）
  - 负面提示词输入（完整模式）

#### 3. 新增功能
- **API测试页面** (`/test`): 用于测试新的API接口
- **参数验证**: 确保API调用的正确性
- **错误处理**: 改进的错误提示和状态管理

### 🚀 使用说明

#### 简化模式（推荐）
1. 输入图片描述
2. 选择图片尺寸
3. 选择AI模型
4. 点击生成

#### 完整模式
1. 输入图片描述
2. 选择图片尺寸
3. 选择AI模型
4. 切换到完整模式
5. 输入负面提示词（可选）
6. 点击生成

### 📊 支持的参数

#### 图片尺寸选项
- 1024×1024
- 1328×1328 (推荐)
- 1536×1536
- 2048×2048

#### AI模型选项
- **qwen-image-plus** (推荐) - 官方推荐模型
- **qwen-image** - 基础模型

### 🧪 测试功能

访问 `/test` 页面可以：
- 测试简化版API
- 测试完整版API
- 查看API响应数据
- 预览生成的图片

### 🔧 技术实现

#### 类型安全
- 完整的TypeScript类型定义
- 接口参数验证
- 响应数据格式化

#### 错误处理
- 网络错误捕获
- API错误信息显示
- 用户友好的错误提示

#### 状态管理
- 生成状态跟踪
- 加载状态显示
- 结果状态管理

### 📝 注意事项

1. **默认参数**: 简化模式使用默认参数，完整模式可自定义所有参数
2. **API选择**: 根据需求选择合适的API模式
3. **错误处理**: 注意API调用的错误处理和用户提示
4. **性能优化**: 大尺寸图片生成时间较长，请耐心等待

### 🎯 下一步计划

- [ ] 添加图片下载功能
- [ ] 实现图片历史记录
- [ ] 添加批量生成功能
- [ ] 优化图片展示效果
